# Excel

### Категория: Forensics
### Сложность: medium

##### Описание:

Кто-то заразил офисный компьютер малварью. Никто не может понять что случилось, остался только дамп RAM этого компьютера. Кстати, нижние подчеркивания хорошее дополнение для Excel...

(Не забудьте обернуть строку в ```ctfcup{}```)

##### Решение:

1. У нас есть образ памяти, проанализируем его с помощью ```Volatility```:
2. ![1](https://i.ibb.co/4gC8R8P/1.jpg) 
3. Список процессов:
4. ![2](https://i.ibb.co/S3Rrcc4/2.jpg)
5. Мы нашли ```EXCEL``` процесс. Теперь нужно извлечь файлы из процесса:
6. ![3](https://i.ibb.co/WH9JLP4/3.jpg)
7. Может что-нибудь в файле ```book.xlsm```? Посмотрим:
8. ![4](https://i.ibb.co/h9j8xZx/4.jpg)
9. Хотя это и таблица Excel с макросом, мы не видим ничего в меню.
10. Значит либо не та версия, либо кто-то что-то скрывает от нас...
11. Если немного поискать, то можно найти утилиту [pcode2code](https://github.com/Big5-sec/pcode2code).
12. Попробуем ```pcodedmp book.xlsm```:
13. ![5](https://i.ibb.co/BnLm99X/5.jpg)
14. Мы видим, что в макросе ```work``` содержится много команд.
15. Но если присмотреться внимательнее, то можно увидеть различимые слова. Каждый номер в линии соответствует столбцу с буквой.
16. Если вспомнить описание таска, то можно вспомнить про нижние подчеркивания.
17. Получаем: ```NOT_ALL_FUNCTIONS_OF_THE_OFFICE_SUITE_SHOULD_BE_USED_IN_A_CORPORATE_ENVIRONMENT_JUST_TRUST_ME_FRIEND```.
18. Оборачиваем в ```ctfcup{}``` и получаем флаг:
19. ```ctfcup{NOT_ALL_FUNCTIONS_OF_THE_OFFICE_SUITE_SHOULD_BE_USED_IN_A_CORPORATE_ENVIRONMENT_JUST_TRUST_ME_FRIEND}```
